/**!
 * @name BiggerStreamPreview
 * @description Adds a button in the context menu to see bigger stream previews.
 * @version 1.0.5
 * @author Jaime Filho
 * @authorId 289112759948410881
 * @invite z6Yx9A8VDR
 * @website https://github.com/jaimeadf/BetterDiscordPlugins/tree/release/src/BiggerStreamPreview
 * @source https://github.com/jaimeadf/BetterDiscordPlugins/tree/release/src/BiggerStreamPreview
 * @updateUrl https://raw.githubusercontent.com/jaimeadf/BetterDiscordPlugins/release/dist/BiggerStreamPreview/BiggerStreamPreview.plugin.js
 */(()=>{"use strict";var e={161:(e,t,r)=>{r.d(t,{Z:()=>o});const n=global.BdApi.React;var i=r.n(n);const o=([e,t])=>{const{DiscordModules:r,WebpackModules:n,Patcher:o,DiscordContextMenu:a}=t,{StreamStore:s,StreamPreviewStore:l,ModalStack:c}=r,u=n.getByDisplayName("ImageModal"),d=n.getByDisplayName("MaskedLink");return class extends e{onStart(){this.patchUserContextMenus()}onStop(){o.unpatchAll()}patchUserContextMenus(){const e=n.findAll((e=>function(e){let t,r=e[0],n=1;for(;n<e.length;){const i=e[n],o=e[n+1];if(n+=2,("optionalAccess"===i||"optionalCall"===i)&&null==r)return;"access"===i||"optionalAccess"===i?(t=r,r=o(r)):"call"!==i&&"optionalCall"!==i||(r=o(((...e)=>r.call(t,...e))),t=void 0)}return r}([e,"optionalAccess",e=>e.default,"optionalAccess",e=>e.displayName,"optionalAccess",e=>e.includes,"call",e=>e("UserContextMenu")]))),t=(e,[t],r)=>{const{user:n}=t,i=s.getStreamForUser(n.id);if(!i)return;const o=l.getPreviewURL(i.guildId,i.channelId,i.ownerId);r.props.children.props.children.push(a.buildMenuItem({type:"separator"}),a.buildMenuItem({label:"View Stream Preview",action:()=>this.showImageModal(o),disabled:null===o}))};for(const r of e)o.after(r,"default",t)}async showImageModal(e){const t=await this.fetchImage(e);c.push(u,{src:e,placeholder:e,original:e,width:t.width,height:t.height,onClickUntrusted:e=>e.openHref(),renderLinkComponent:e=>i().createElement(d,{...e})})}async fetchImage(e){return new Promise(((t,r)=>{const n=new Image;n.src=e,n.addEventListener("load",(()=>{t(n)})),n.addEventListener("error",(()=>{r(new Error("Image not found"))}))}))}}}},883:(e,t,r)=>{r.d(t,{default:()=>f});const n=require("fs");var i=r.n(n);const o=require("path");var a=r.n(o);const s=require("request");var l=r.n(s);const c=require("electron");var u=r.n(c);const d={BdApi:global.BdApi},g=global.ZeresPluginLibrary;var p=r.n(g),h=r(161);const m={info:{name:"BiggerStreamPreview",description:"Adds a button in the context menu to see bigger stream previews.",version:"1.0.5",authors:[{name:"Jaime Filho",discord_id:"289112759948410881"}],github:"https://github.com/jaimeadf/BetterDiscordPlugins/tree/release/src/BiggerStreamPreview",github_raw:"https://raw.githubusercontent.com/jaimeadf/BetterDiscordPlugins/release/dist/BiggerStreamPreview/BiggerStreamPreview.plugin.js"}},f=p()?(0,h.Z)(p().buildPlugin(m)):class{constructor(){this._config=m}getName(){return m.info.name}getAuthor(){return m.info.authors.map((e=>e.name)).join(", ")}getDescription(){return m.info.description}getVersion(){return m.info.version}load(){d.BdApi.showConfirmationModal("Library plugin is needed",`The library plugin needed for ${m.info.name} is missing. Please click Download Now to install it.`,{confirmText:"Download",cancelText:"Cancel",onConfirm(){l().get("https://rauenzi.github.io/BDPluginLibrary/release/0PluginLibrary.plugin.js",((e,t,r)=>{if(e)return u().shell.openExternal("https://betterdiscord.net/ghdl?url=https://raw.githubusercontent.com/rauenzi/BDPluginLibrary/master/release/0PluginLibrary.plugin.js");i().writeFileSync(a().join(d.BdApi.Plugins.folder,"0PluginLibrary.plugin.js"),r)}))}})}start(){}stop(){}}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r(161);var n=r(883);module.exports=n.default})();